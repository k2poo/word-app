<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>è‹±å˜èªæš—è¨˜ã‚¢ãƒ—ãƒª by Koji NIHEI 2026</title>

<style>
body{
  font-family: Arial;
  background:#fff5fb;
  padding:15px;
}
h2{ color:#ff7eb8; }
.screen{ display:none; }
.card{
  background:white;
  padding:15px;
  border-radius:18px;
  box-shadow:0 4px 10px rgba(0,0,0,0.08);
  margin-bottom:15px;
}
button{
  padding:10px 14px;
  border-radius:20px;
  border:none;
  font-size:14px;
}
.btn-pink{ background:#ff9bcd; }
.btn-green{ background:#9be1a7; }
.btn-blue{ background:#9bd8ff; }
.btn-gray{ background:#dddddd; }
.big{
  font-size:30px;
  margin:12px 0;
  cursor:pointer;
}
</style>
</head>

<body>

<h2>ğŸŒ¸ è‹±å˜èªæš—è¨˜ã‚¢ãƒ—ãƒª by Koji NIHEI 2026 ğŸŒ¸</h2>

<!-- ãƒªã‚¹ãƒˆé¸æŠ -->
<div id="listScreen" class="screen card">
  <h3>ğŸ“š ãƒªã‚¹ãƒˆã‚’é¸ã‚“ã§ã­</h3>
  <div id="listContainer"></div>
</div>

<!-- å­¦ç¿’ç”»é¢ -->
<div id="studyScreen" class="screen card">
  <h3 id="studyTitle"></h3>
  <div class="big" id="questionWord" onclick="speakText()"></div>
  <div class="big" id="answerMeaning" style="color:#0077ff;"></div>

  <button class="btn-green" onclick="markKnow()">åˆ†ã‹ã‚‹</button>
  <button class="btn-pink" onclick="markDontKnow()">åˆ†ã‹ã‚‰ãªã„</button>
</div>

<script>

// ================== ãƒ‡ãƒ¼ã‚¿ ==================
const lists = [
  {
    title:"ã‚µãƒ³ãƒ—ãƒ«",
    items:[
      {word:"apple", meaning:"ã‚Šã‚“ã”"},
      {word:"dog", meaning:"çŠ¬"},
      {word:"cat", meaning:"çŒ«"}
    ]
  }
];

let currentList=[];
let title="";
let order=[];
let index=0;

let dontKnow=[];
let round=1;
let fullRoundCount=0; // â˜… å…¨å•çµ‚äº†å›æ•°

// ================== ç”»é¢åˆ‡æ›¿ ==================
function show(id){
  document.querySelectorAll(".screen").forEach(s=>s.style.display="none");
  document.getElementById(id).style.display="block";
}

// ================== ãƒªã‚¹ãƒˆè¡¨ç¤º ==================
function loadLists(){
  let c=document.getElementById("listContainer");
  c.innerHTML="";
  lists.forEach((l,i)=>{
    let btn=document.createElement("button");
    btn.className="btn-blue";
    btn.innerText=l.title;
    btn.onclick=()=>startStudy(i);
    c.appendChild(btn);
  });
  show("listScreen");
}

// ================== å­¦ç¿’é–‹å§‹ ==================
function startStudy(i){
  currentList=[...lists[i].items];
  title=lists[i].title;
  round=1;
  fullRoundCount=0;
  dontKnow=[];
  resetOrder();
  show("studyScreen");
  nextQuestion();
}

function resetOrder(){
  order=[...currentList.keys()];
  order.sort(()=>Math.random()-0.5);
  index=0;
}

// ================== å‡ºé¡Œ ==================
function nextQuestion(){

  // â˜… å…¨å•çµ‚äº†
  if(index >= order.length){
    fullRoundCount++;

    // â‘  é–“é•ã„ã‚¼ãƒ­ â†’ çµ‚äº†ç¢ºèª
    if(dontKnow.length === 0){
      if(confirm("é–“é•ã„ãŒãªããªã‚Šã¾ã—ãŸã€‚\nç·´ç¿’ã‚’çµ‚ã‚ã‚Šã¾ã™ã‹ï¼Ÿ")){
        show("listScreen");
        return;
      }
    }

    // â‘¡ 3å›ç¹°ã‚Šè¿”ã— â†’ å¼·åˆ¶çµ‚äº†
    if(fullRoundCount >= 3){
      alert("3å›ç¹°ã‚Šè¿”ã—ãŸã®ã§ã€ä»Šå›ã¯çµ‚äº†ã§ã™ã€‚");
      show("listScreen");
      return;
    }

    // é–“é•ã„ã®ã¿å†å‡ºé¡Œ
    if(dontKnow.length > 0){
      currentList = dontKnow.map(i=>currentList[i]);
      dontKnow=[];
    }

    round++;
    resetOrder();
  }

  let qIndex=order[index];
  let item=currentList[qIndex];

  document.getElementById("studyTitle").innerText =
    `${title}ï¼ˆ${round}å·¡ç›® / å…¨å•${fullRoundCount}å›ï¼‰`;

  document.getElementById("questionWord").innerText=item.word;
  document.getElementById("answerMeaning").innerText="";
}

// ======
